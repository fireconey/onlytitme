window.onload = function () {    initbody();    changelabel()    showdetail()    tolist()    bar()    filldata()}window.onresize = function () {    initbody();}function initbody() {    var h = window.innerHeight;    var ob = document.getElementById("container");    var w = ob.offsetWidth;    ob.style.height = w / 0.3319016 + "px";    var headp = document.getElementById("headp")    headp.style.width = headp.offsetHeight + "px"    var img = $(".photo").getEl("all")    var imgh = img[0].offsetHeight    for (var i in img) {        img[i].style.width = imgh + "px"    }}//点击对应组的对应分类进入对应分类的列表/**1、使用一个参数来标记展示那段数据flag*2、flag:表示第几组的数据* 3、local表示地区的数据* 4、n，m表示要查询的分段，便于滚动*** */var timer1=0var timer2=0var timer3=0var timer4=0function filldata() {    var label = $(".tag").findchild("a")    var local0 = tool2(label.getEl(0))    var local1 = tool2(label.getEl(1))    var local2 = tool2(label.getEl(2))    var local3 = tool2(label.getEl(3))    if (tool2(label.getEl(0)) == "自分组") {        fillpart(local0, 0, 1)        timer1=window.setInterval(function () {           fillpart(local0, 0, 1)        },10000);    }    else{         fillpart(local0, 1, 2)        timer1=window.setInterval(function () {           fillpart(local0, 1, 2)        },10000);    }    if (tool2(label.getEl(1)) == "县/区") {        fillpart(local1, 1, 1)        timer2=window.setInterval(function () {           fillpart(local1, 1, 1)        },10000);    }else{        fillpart(local1, 1, 2)        timer2=window.setInterval(function () {           fillpart(local1, 1, 2)        },10000);    }    if (tool2(label.getEl(2)) == "市级") {         fillpart(local2, 2, 1)        timer3=window.setInterval(function () {           fillpart(local2, 2, 1)        },10000);    }else {         fillpart(local2, 2, 2)         timer3=window.setInterval(function () {           fillpart(local2, 2, 2)        },10000);    }    if (tool2(label.getEl(3)) == "省级") {        fillpart(local3, 3, 1)        timer4=window.setInterval(function () {           fillpart(local3, 3, 1)        },10000);    }else {         fillpart(local3, 3, 2)        timer4=window.setInterval(function () {           fillpart(local3, 3, 2)        },10000);    }}/** 填充的子函数* */function fillpart(local, flag, state) {    var title = $(".text")    var img = $(".photo")    var name = $(".name")        $().ajax({            "type": "post",            "url": "index",            "data": {"local": local, "flag": flag, "n": 0, "m": 15, "tag": "fill", "state": state},            "fn": function (value) {              var  temp = JSON.parse(value.responseText)                for (var j = 0; j < 15; j++) {                    title.getEl(flag * 15 + j).innerText = temp["title"][j]                    name.getEl(flag * 15 + j).innerText = temp["usr"][j]                    img.getEl(flag * 15 + j).setAttribute("src", temp["img"][j])                }            }        });    }/**查询不同地区的数据* */function changelabel() {    var title = $(".tag").findchild("a")    var changeinput = $(".changeinput")    var changeyes = $(".changeyes")    title.getEl(0).innerText = "自分组------>>>"    title.getEl(1).innerText = "县/区------>>>"    title.getEl(2).innerText = "市级------>>>"    title.getEl(3).innerText = "省级------>>>"    var tr=["timer1","timer2","timer3","timer4"]    for (var i = 0; i < 4; i++) {        (            function (rt,timer) {                changeyes.getEl(rt).onclick = function () {                    $().ajax({                        "type": "post",                        "url": "index",                        "data": {"local": changeinput.getEl(rt).value, "flag": rt, "tag": "qry"},                        "fn": function (some) {                            var result = tool(some.responseText)                            result = JSON.parse(result)                            if (result["result"]) {                                var changevalue=changeinput.getEl(rt).value.trim()                                title.getEl(rt).innerText =changevalue+ "------>>>"                                fillpart(changevalue,rt,2)                                changeinput.getEl(rt).value                                window.clearInterval(window[timer[rt]])                            }                            else {                                alert("没有此地区的数据")                            }                        }                    })                }            }        )(i,tr)    }}/** 点击不同的标签进入详情页面* */function showdetail() {    var ob = $(".li")    var title = $(".text")    var name = $(".name")    for (var i = 0; i < 4; i++) {        for (var j = 0; j < 15; j++) {            (function (value) {                    ob.getEl(value).onclick = function () {                        var titlevalue=title.getEl(value).innerText.trim()                        var usr=name.getEl(value).innerText.trim()                        if(titlevalue=="无数据")                        {                            alert("无数据")                            return "temp"                        }                        //由于flag标记是否是登录所以使用fl表示区域                        document.cookie="_title="+encodeURIComponent(titlevalue)+";"                        document.cookie="_name="+encodeURIComponent(usr)+";"                        document.cookie="_fl="+encodeURIComponent(value)+";"                        window.location.href="timenewsdetail"                    }                }            )(i * 15 + j)        }    }}/** 点击分组的标签进入列表栏* */function tolist() {    var title = $(".tag").findchild("a")    for (var i = 0; i < 4; i++) {        (function (value) {            var tag = 2            title.getEl(value).onclick = function () {                var local = title.getEl(value).innerText.replace(/------>>>/g, "")                if (local == "自分组") {                    local = "*"                    tag = 1                }                if (local == "县/区") {                    local = "*"                    tag = 1                }                if (local == "市级") {                    local = "*"                    tag = 1                }                if (local == "省级") {                    local = "*"                    tag = 1                }                $().ajax({                    "type": "post",                    "url": "newslist",                    "data": {"flag": value, "local": local, "tag": tag, "from": "indexlabel"},                    "fn": function (some) {                        window.location.href = "newslist"                    }                })            }        })(i)    }}/** 标题栏功能* */function bar() {    var ob = $("#list").findchild("li")    var head = $("#headp").getEl(0)    head.onclick = function () {        window.location.href = "userInfo"    }    for (var i = 0; i < 7; i++) {        (function (i) {            ob.getEl(i).onclick = function () {                var text = this.innerText.replace(/\s+/g, "")                var local = "*"                var flag = 0                var tag = 1                var from = "indexbar"                if (text == "县/区") {                    flag = 1                }                else if (text == "市级") {                    flag = 2                }                else if (text == "省级") {                    flag = 3                }                else if (i <= 4 & i > 0 & text != "自分组") {                    local = text                    flag = i - 1                    tag = 2                }                if (i == 0)                    window.location.href = "index"                if (i <= 4 & i > 0) {                    $().ajax({                        "type": "post",                        "url": "newslist",                        "data": {"local": local, "flag": flag, "tag": tag, "from": from},                        "fn": function (value) {                            window.location.href = value.responseText                        }                    })                }                if (text == "登录") {                    window.location.href = "loading"                }                if (text == "退出") {                    window.location.href = "quite"                }                if (text == "注册") {                    window.location.href = "regist"                }            }        })(i)    }}function tool(value) {    var result = value.replace(/\s+/g, "")    result = result.replace(/\'/g, '"')    return result}function tool2(value) {    var result = value.innerText.replace(/\------>>>/g, "").trim()    return result}